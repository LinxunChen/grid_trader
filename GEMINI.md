# 项目上下文说明 (For Gemini)

## 1. 项目名称
状态化网格交易助手 (Stateful Grid Trading Assistant)

## 2. 项目绝对路径
`/Users/linxun/CodeSpace/grid_trader`

## 3. 技术方案
- **语言**: Python
- **核心库**: `yfinance` 用于获取金融数据。
- **配置文件**: `app_config.json` 用于管理所有资产的个性化策略和实时状态。
- **交易日志**: `transactions.csv` 用于记录所有交易历史。
- **部署方案**: 通过 `Dockerfile` 构建Docker镜像，实现自动化部署。

## 4. 版本控制
- **系统**: Git
- **远程仓库地址**: `git@github.com:LinxunChen/grid_trader.git`
- **主分支**: `main`

## 5. 当前项目状态与核心逻辑
- 程序是一个同步的、单线程的状态机，通过循环读取和写入 `app_config.json` 来管理状态。
- 支持对多个ETF资产进行个性化参数配置（如网格比例、止盈线）。
- 实现了“提醒-交易-反馈”的闭环：
  1. 价格触发时，程序在JSON文件中将资产的 `is_waiting...` 标志设为 `true`。
  2. 用户在场外完成交易后，手动将JSON中的标志改回 `false`。
  3. 程序检测到此变化，会提示用户在终端输入交易结果（价格、新成本）。
  4. 程序根据输入，计算并更新下一次的买/卖提醒价，并将新状态写回JSON文件。
- 股息率通过手动加总过去一年的真实历史分红来计算，以保证准确性。
- 价格获取有回退机制，以提高稳定性。
- 所有文件读写均强制使用UTF-8编码，以正确处理中文字符。

## 6. 上次完成的工作
- 彻底修复了股息率计算不准和逻辑错误的问题。
- 将最终稳定版代码推送到了GitHub。
- 确认了后续的开发协作流程。
